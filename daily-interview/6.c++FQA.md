# FQA

#### 老王：1. 在c++的构造函数内调用虚函数可以吗？

   小王：

在构造函数内 可以调用虚函数，但是不推荐（一句话描述结果）

解释：

因为一个虚函数调用过程是 通过基类指针或者引用触发的例如

this->vptr[index] ，

> 从普通语法看判断 ptr为null还是不null

一、 首先判断 虚表 存在不存在，

在编译阶段，一个类多少个虚函数 已经确定，系统为每个类产生固定大小的虚表，在类的构造函数【没有问题】

二、 判断虚指针是否初始化。

虚指针初始化是在构造函数体内函数执行之前【没有问题】



![1571974107778](../images/201909/1571974107778.png)

具体情况  [深度探索C++对象模型](https://mp.weixin.qq.com/s/pAoIe9m2Oat7d8c_ZW5Qyg)

![1571973743450](../images/201909/1571973743450.png)

三、 但是不推荐这么做【有问题了】

是因为，在类的构造函数内，对象还没有初始化完毕，就相当于构造函数还还没有执行完毕，

就开始调用普通成员函数，会造成无法预估的后果。类比静态函数，虽然可以在类没有构造时候被调用，但是只能影响范围静态成员变量。错误的做法，从语法上做限制。



> 另外，调用虚函数，并没有发挥虚函数的机制，只是普通函数调用而已。





#### 老王：2. c++在拷贝构造过程中，深拷贝和浅拷贝有什么区别？

小王： 

前者会生成默认拷贝构造函数，后者不会。

> 深拷贝和浅拷贝 是c++ 根据类成员不同 提供默认2个不同行为，（一句结束）

浅拷贝就是bitwisecopy，类比memcopy，不需要生成拷贝构造函数,安全创建一个对象

深拷贝是memberwise copy，根据成员不同调用对应拷贝构造函数的等，安全创建一个对象。







正如：

![1571975220948](../images/201909/1571975220948.png)

![默认行为是什么](../images/201909/1571977485773.png)

![1571975239172](../images/201909/1571975239172.png)

#### 老王：3 指针和引用区别 是什么，各自使用场景是什么？

大王：有没有一点创意呀，这题目被问多少次了，每次听到都是罗里罗嗦，小王回答一下。

小王：

### ref

-  https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom 
-  https://people.cs.clemson.edu/~rlowe/cs1070/notes/copy_constructor.pdf 

